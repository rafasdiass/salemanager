<ion-content class="first-access-container">
  <ion-header>
    <ion-toolbar>
      <ion-buttons slot="start">
        <ion-button fill="clear" (click)="navigateToLogin()">
          <ion-icon name="arrow-back"></ion-icon> Voltar
        </ion-button>
      </ion-buttons>
      <ion-title>
        <ion-icon name="person-add"></ion-icon> Primeiro Acesso
      </ion-title>
    </ion-toolbar>
  </ion-header>

  <ion-grid class="form-container">
    <ion-row>
      <ion-col size="12" class="text-center">
        <h2><ion-icon name="key"></ion-icon> Criar Senha</h2>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col size="12">
        <form [formGroup]="firstAccessForm" (ngSubmit)="submitForm()">
          <!-- CPF -->
          <ion-item class="input-field">
            <ion-icon name="person" slot="start"></ion-icon>
            <ion-label position="floating">CPF</ion-label>
            <ion-input formControlName="cpf"></ion-input>
          </ion-item>
          <ion-text color="danger" *ngIf="firstAccessForm.get('cpf')?.invalid && firstAccessForm.get('cpf')?.touched">
            <p class="error-message">
              <ion-icon name="alert-circle"></ion-icon> CPF inválido. Deve conter 11 dígitos numéricos.
            </p>
          </ion-text>

          <!-- Nova Senha -->
          <ion-item class="input-field">
            <ion-icon name="lock-closed" slot="start"></ion-icon>
            <ion-label position="floating">Nova Senha</ion-label>
            <ion-input type="password" formControlName="password"></ion-input>
          </ion-item>
          <ion-text color="danger"
            *ngIf="firstAccessForm.get('password')?.invalid && firstAccessForm.get('password')?.touched">
            <p class="error-message">
              <ion-icon name="alert-circle"></ion-icon> A senha deve conter exatamente 11 caracteres e incluir letras e
              números.
            </p>
          </ion-text>

          <!-- Confirmar Senha -->
          <ion-item class="input-field">
            <ion-icon name="shield-checkmark" slot="start"></ion-icon>
            <ion-label position="floating">Confirmar Senha</ion-label>
            <ion-input type="password" formControlName="confirmPassword"></ion-input>
          </ion-item>
          <ion-text color="danger" *ngIf="firstAccessForm.errors?.['mismatch']">
            <p class="error-message">
              <ion-icon name="alert-circle"></ion-icon> As senhas não coincidem.
            </p>
          </ion-text>

          <!-- Botão de Definir Senha -->
          <ion-button expand="block" type="submit" [disabled]="firstAccessForm.invalid">
            <ion-icon name="checkmark-circle"></ion-icon> Definir Senha
          </ion-button>

          <!-- Botão de Voltar para Login -->
          <ion-button expand="block" fill="outline" color="medium" (click)="navigateToLogin()">
            <ion-icon name="log-in"></ion-icon> Já tenho uma conta
          </ion-button>
        </form>

        <!-- Mensagem de erro -->
        <ion-text color="danger" *ngIf="errorMessage">
          <p class="error-message">
            <ion-icon name="alert-circle"></ion-icon> {{ errorMessage }}
          </p>
        </ion-text>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>