<ion-content class="view-employee-details">
  <ion-header>
    <ion-toolbar>
      <ion-buttons slot="start">
        <ion-button (click)="closeModal()">
          <ion-icon name="close"></ion-icon>
        </ion-button>
      </ion-buttons>
      <ion-title>Detalhes do employee</ion-title>
    </ion-toolbar>
  </ion-header>

  <div class="container">
    <ng-container *ngIf="!isLoading(); else loadingSpinner">
      <ng-container *ngIf="employeeSelecionado() as employee">
        <!-- Informações do employee -->
        <ion-card>
          <ion-card-content>
            <h2>{{ employee.first_name }} {{ employee.last_name }}</h2>
            <ion-list>
              <ion-item>
                <ion-icon name="document-text" slot="start"></ion-icon>
                <ion-label><strong>CPF:</strong> {{ employee.cpf }}</ion-label>
              </ion-item>
              <ion-item>
                <ion-icon name="mail" slot="start"></ion-icon>
                <ion-label><strong>Email:</strong> {{ employee.email }}</ion-label>
              </ion-item>
              <ion-item>
                <ion-icon name="call" slot="start"></ion-icon>
                <ion-label><strong>Telefone:</strong> {{ employee.phone }}</ion-label>
              </ion-item>
              <ion-item>
                <ion-icon name="calendar" slot="start"></ion-icon>
                <ion-label><strong>Data de Atuação:</strong> {{ employee.dataAtuacaoInicio }}</ion-label>
              </ion-item>
              <ion-item *ngIf="employee.address">
                <ion-icon name="location" slot="start"></ion-icon>
                <ion-label>
                  <strong>Endereço:</strong> {{ employee.address.street }},
                  {{ employee.address.number }} - {{ employee.address.neighborhood }},
                  {{ employee.address.city }} - {{ employee.address.state }},
                  CEP: {{ employee.address.postal_code }}
                </ion-label>
              </ion-item>
            </ion-list>
          </ion-card-content>
        </ion-card>

        <!-- Dados de Desempenho -->
        <ion-card *ngIf="employee.desempenho">
          <ion-card-content>
            <h3>Desempenho</h3>
            <ion-list>
              <ion-item>
                <ion-icon name="people" slot="start"></ion-icon>
                <ion-label><strong>Total de clients:</strong> {{ employee.desempenho.totalclients || 0
                  }}</ion-label>
              </ion-item>
              <ion-item>
                <ion-icon name="document-text" slot="start"></ion-icon>
                <ion-label><strong>Total de Adesões:</strong> {{ employee.desempenho.totalAdesoes || 0 }}</ion-label>
              </ion-item>
              <ion-item>
                <ion-icon name="alert-circle" slot="start"></ion-icon>
                <ion-label><strong>Adesões Pendentes:</strong> {{ employee.desempenho.totalPendentes || 0
                  }}</ion-label>
              </ion-item>
              <ion-item>
                <ion-icon name="checkmark-circle" slot="start"></ion-icon>
                <ion-label><strong>Adesões Aprovadas:</strong> {{ employee.desempenho.totalAprovadas || 0
                  }}</ion-label>
              </ion-item>
            </ion-list>
          </ion-card-content>
        </ion-card>

        <!-- Lista de clients -->
        <ion-card *ngIf="employee.clients?.length">
          <ion-card-content>
            <h3>clients</h3>
            <ion-list>
              <ion-item *ngFor="let client of employee.clients">
                <ion-icon name="person-circle" slot="start"></ion-icon>
                <ion-label>
                  <strong>{{ client.first_name }} {{ client.last_name }}</strong> - CPF: {{ client.cpf }}
                </ion-label>
              </ion-item>
            </ion-list>
          </ion-card-content>
        </ion-card>

        <!-- Lista de Adesões -->
        <ion-card *ngIf="employee.adesoes?.length">
          <ion-card-content>
            <h3>Adesões</h3>
            <ion-list>
              <ion-item *ngFor="let adesao of employee.adesoes">
                <ion-icon name="document-text" slot="start"></ion-icon>
                <ion-label>
                  <strong>{{ adesao.titulo }}</strong> - Status: {{ adesao.status }}
                </ion-label>
              </ion-item>
            </ion-list>
          </ion-card-content>
        </ion-card>
      </ng-container>
    </ng-container>

    <!-- Spinner de carregamento -->
    <ng-template #loadingSpinner>
      <ion-spinner name="crescent"></ion-spinner>
      <p>Carregando detalhes do employee...</p>
    </ng-template>
  </div>

  <!-- Rodapé com Botão de Cancelar -->
  <ion-footer>
    <ion-toolbar>
      <ion-buttons slot="end">
        <ion-button color="danger" (click)="closeModal()">
          <ion-icon name="close-circle"></ion-icon> Cancelar
        </ion-button>
      </ion-buttons>
    </ion-toolbar>
  </ion-footer>
</ion-content>