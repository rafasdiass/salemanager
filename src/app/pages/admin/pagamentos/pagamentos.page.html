<ion-content class="pagamentos-page">
  <ion-header>
    <ion-toolbar>
      <ion-title>Pagamentos</ion-title>
    </ion-toolbar>
  </ion-header>

  <!-- Loader -->
  <div *ngIf="isLoading" class="loading-container">
    <ion-spinner></ion-spinner>
    <p>Carregando pagamentos...</p>
  </div>

  <!-- Mensagem de erro -->
  <div *ngIf="errorMessage" class="error-container">
    <p class="error-message">
      <i class="bi bi-exclamation-triangle-fill" aria-hidden="true" title="Erro"></i>
      {{ errorMessage }}
    </p>
  </div>

  <!-- Nenhum pagamento encontrado -->
  <div
    *ngIf="!isLoading && !errorMessage && !pagamentosAReceber.length && !pagamentosRealizados.length && !pagamentosAtrasados.length && !pagamentosCancelados.length"
    class="text-center">
    <p class="text-muted">Nenhum pagamento encontrado.</p>
  </div>

  <!-- ConteÃºdo dos pagamentos -->
  <div *ngIf="!isLoading && !errorMessage" class="container">
    <!-- Pagamentos a Receber -->
    <div class="category-section">
      <h3>
        <i class="bi bi-cash-coin" aria-hidden="true" title="Pagamentos a Receber"></i>
        Pagamentos a Receber
      </h3>
      <ul class="list-group">
        <li *ngFor="let pagamento of pagamentosAReceber" class="list-group-item"
          [ngClass]="{ 'text-warning': isProximoVencimento(pagamento) }">
          <strong>{{ pagamento.client.first_name }} {{ pagamento.client.last_name }}</strong> -
          R$ {{ pagamento.valor.toFixed(2) }}
          <span class="badge bg-primary">Vence em {{ pagamento.vencimento | date: 'dd/MM/yyyy' }}</span>
        </li>
        <li *ngIf="pagamentosAReceber.length === 0" class="list-group-item text-muted">
          Nenhum pagamento a receber.
        </li>
      </ul>
    </div>

    <!-- Pagamentos Realizados -->
    <div class="category-section">
      <h3>
        <i class="bi bi-check-circle-fill" aria-hidden="true" title="Pagamentos Realizados"></i>
        Pagamentos Realizados
      </h3>
      <ul class="list-group">
        <li *ngFor="let pagamento of pagamentosRealizados" class="list-group-item">
          <strong>{{ pagamento.client.first_name }} {{ pagamento.client.last_name }}</strong> -
          R$ {{ pagamento.valor.toFixed(2) }}
          <span class="badge bg-success">Pago em {{ pagamento.data | date: 'dd/MM/yyyy' }}</span>
        </li>
        <li *ngIf="pagamentosRealizados.length === 0" class="list-group-item text-muted">
          Nenhum pagamento realizado.
        </li>
      </ul>
    </div>

    <!-- Pagamentos Atrasados -->
    <div class="category-section">
      <h3>
        <i class="bi bi-exclamation-circle-fill" aria-hidden="true" title="Pagamentos Atrasados"></i>
        Pagamentos Atrasados
      </h3>
      <ul class="list-group">
        <li *ngFor="let pagamento of pagamentosAtrasados" class="list-group-item">
          <strong>{{ pagamento.client.first_name }} {{ pagamento.client.last_name }}</strong> -
          R$ {{ pagamento.valor.toFixed(2) }}
          <span class="badge bg-danger">Atrasado desde {{ pagamento.data | date: 'dd/MM/yyyy' }}</span>
        </li>
        <li *ngIf="pagamentosAtrasados.length === 0" class="list-group-item text-muted">
          Nenhum pagamento atrasado.
        </li>
      </ul>
    </div>

    <!-- Pagamentos Cancelados -->
    <div class="category-section">
      <h3>
        <i class="bi bi-x-circle-fill" aria-hidden="true" title="Pagamentos Cancelados"></i>
        Pagamentos Cancelados
      </h3>
      <ul class="list-group">
        <li *ngFor="let pagamento of pagamentosCancelados" class="list-group-item">
          <strong>{{ pagamento.client.first_name }} {{ pagamento.client.last_name }}</strong> -
          R$ {{ pagamento.valor.toFixed(2) }}
          <span class="badge bg-secondary">Cancelado em {{ pagamento.data | date: 'dd/MM/yyyy' }}</span>
        </li>
        <li *ngIf="pagamentosCancelados.length === 0" class="list-group-item text-muted">
          Nenhum pagamento cancelado.
        </li>
      </ul>
    </div>
  </div>
</ion-content>