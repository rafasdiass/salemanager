<ion-content class="view-client-details">
  <!-- Cabeçalho -->
  <ion-header>
    <ion-toolbar>
      <ion-buttons slot="start">
        <ion-button (click)="closeModal()">
          <ion-icon name="close"></ion-icon>
        </ion-button>
      </ion-buttons>
      <ion-title>Detalhes do client</ion-title>
    </ion-toolbar>
  </ion-header>

  <!-- Loading Inicial -->
  <ion-card *ngIf="!client; else clientDetails">
    <ion-card-content class="text-center">
      <ion-spinner name="crescent"></ion-spinner>
      <p>Carregando informações...</p>
    </ion-card-content>
  </ion-card>

  <!-- Detalhes do client -->
  <ng-template #clientDetails>
    <ion-card>
      <ion-card-header>
        <ion-title>{{ client?.first_name }} {{ client?.last_name }}</ion-title>
      </ion-card-header>
      <ion-card-content>
        <ion-list>
          <ion-item>
            <ion-label><strong>CPF:</strong> {{ client?.cpf }}</ion-label>
          </ion-item>
          <ion-item>
            <ion-label><strong>Email:</strong> {{ client?.email }}</ion-label>
          </ion-item>
          <ion-item>
            <ion-label><strong>Telefone:</strong> {{ client?.phone }}</ion-label>
          </ion-item>
          <ion-item>
            <ion-label>
              <strong>Endereço:</strong>
              {{ client?.address?.street }}, {{ client?.address?.number }} -
              {{ client?.address?.neighborhood }}, {{ client?.address?.city }} -
              {{ client?.address?.state }}, CEP: {{ client?.address?.postal_code }}
            </ion-label>
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>

    <!-- Adesões -->
    <ion-card>
      <ion-card-header>
        <ion-title>Adesões</ion-title>
      </ion-card-header>
      <ion-card-content>
        <ion-list *ngIf="!isLoading; else loadingSpinner">
          <ion-item *ngIf="adesoes.length === 0">
            <ion-label>Não há adesões cadastradas para este client.</ion-label>
          </ion-item>

          <ion-item *ngFor="let adesao of adesoes">
            <ion-grid>
              <ion-row>
                <ion-col>
                  <h4>{{ adesao.titulo }}</h4>
                  <p><strong>Status:</strong> {{ adesao.status | titlecase }}</p>
                  <p><strong>Programa Habitacional:</strong> {{ adesao.programaHabitacional }}</p>
                  <p><strong>Fase:</strong> {{ adesao.fase }}</p>
                  <p><strong>Tipo de Unidade:</strong> {{ adesao.tipoUnidade }}</p>
                </ion-col>
              </ion-row>
              <ion-row>
                <ion-col>
                  <ion-label><strong>Valor Adesão:</strong> R$ {{ adesao.valorAdesao | number: '1.2-2' }}</ion-label>
                </ion-col>
                <ion-col>
                  <ion-label><strong>Restante Sem Juros:</strong> R$ {{ adesao.valorRestanteSemJuros | number: '1.2-2'
                    }}</ion-label>
                </ion-col>
                <ion-col>
                  <ion-label><strong>Restante Com Juros:</strong> R$ {{ adesao.valorRestanteComJuros | number: '1.2-2'
                    }}</ion-label>
                </ion-col>
              </ion-row>
            </ion-grid>
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>

    <!-- Spinner de carregamento -->
    <ng-template #loadingSpinner>
      <ion-item>
        <ion-spinner name="crescent"></ion-spinner>
        <p>Carregando adesões...</p>
      </ion-item>
    </ng-template>
  </ng-template>
</ion-content>